---
title: "TLS and Certificate Management"
description: "Transport Layer Security and Tyk Certificate Store"
keywords: "Transport Layer Security, TLS, SSL, mTLS, mutual TLS, Security, Certificate, Pinning, Certificate Authority, Tyk Certificate Store"
order: 2
sidebarTitle: "TLS and Certificate Management"
---

## Introduction

Modern web applications require secure communication to protect sensitive data from eavesdropping and tampering. Transport Layer Security (TLS) is the foundation of secure internet communication, and Tyk provides comprehensive TLS support for both client-facing APIs and backend service communication.

## Understanding Secure Communication

**[DIAGRAM: Before/After Hero Visual]** _Left panel: Insecure communication showing data packets with warning icons, eavesdropper figures, and "DANGER" indicators. Right panel: Same communication secured with TLS showing encrypted packets, lock icons, and shield symbols._

### The Problem: Insecure Communication

Without encryption, network communication faces several risks:

- **Eavesdropping**: Anyone can read your data as it travels across networks
- **Tampering**: Attackers can modify data in transit without detection
- **Impersonation**: Malicious actors can pretend to be legitimate servers or clients

### The Solution: Transport Layer Security (TLS)

**TLS (Transport Layer Security)** is a cryptographic protocol that solves these problems by providing:

- **Confidentiality**: Encrypts data so only intended recipients can read it
- **Integrity**: Ensures data hasn't been modified during transmission
- **Authentication**: Verifies the identity of communicating parties

TLS is the "S" in HTTPS and secures billions of web transactions daily.

#### TLS or SSL

SSL (Secure Sockets Layer) is the outdated predecessor to TLS (Transport Layer Security), the modern standard for securing internet communication, with TLS offering superior security through stronger encryption algorithms, more efficient handshakes, and improved key management. All SSL versions and older TLS versions (1.0, 1.1) are now deprecated and considered vulnerable. While people may still use "SSL" as a catch-all term, they are usually referring to TLS, with TLS 1.2 and especially TLS 1.3 being the current secure protocols.

## Fundamentals of Public Key Cryptography

Transport Layer Security uses a technique called public key cryptography. This is an asymmetric cryptographic approach where each party holds one of a pair of *keys* that can be used to encrypt or decrypt messages.

### Encryption Keys

A *key* is a piece of information used for scrambling (encrypting) data using a defined algorithm so that it appears random. This encrypted data can be descrambled (decrypted) back to the original information using the appropriate algorithm and *key*.

With public key cryptography there are two different keys:
- the *private key* is held by the originator of the message and is kept private
- the *public key* is shared with the recipient of the message

A key exchange algorithm, such as RSA, uses the public-private key pair to agree upon session keys, which are used for symmetric encryption once the handshake is complete.

[DIAGRAM: Public Key Encryption] Visual representation of asymmetric encryption with Party A using Party B's public key to encrypt, Party B using their private key to decrypt. Visual flow arrows showing data encryption/decryption process

### Digital Certificates

[DIAGRAM: Certificate Anatomy] Visual representation of a digital certificate styled like an ID card or passport, with clearly labeled sections showing: - Public key (represented as a key icon) - Identity information (name, organization, domain) - Digital signature (CA seal/stamp) - Validity dates (calendar icons) - Serial number (barcode or ID number)

The public key is usually shared in the form of an [X.509](https://datatracker.ietf.org/doc/html/rfc5280) *digital certificate*. This is like a digital passport or driver's license. It's an electronic document that proves identity and contains the elements shown above. The certificate is itself *signed* using the private key owned by an entity that is trusted by both parties, known as a *Certificate Authority*.

### Certificate Authorities (CAs)

[DIAGRAM: Trust Store Concept] Illustration showing: - Browser/OS icon with "Trust Store" database - Icons of major CAs (Let's Encrypt, DigiCert, GlobalSign logos) - Arrows showing certificate validation flow - Checkmark indicating "Trusted" status

Certificate Authorities are trusted organizations that issue digital certificates. They act like government agencies that issue passports.

Popular Certificate Authorities include:
- Let's Encrypt: Free, automated certificates
- DigiCert: Enterprise-grade certificates
- GlobalSign: International CA with global presence
- Internal CAs: Organizations can run their own CAs for internal use (self-signed certificates)

### Certificate Chains and Trust

[DIAGRAM: Certificate Chain Hierarchy] Visual tree diagram showing: - Root CA Certificate (crown icon, self-signed badge) - Arrow down with "signs" label - Intermediate CA Certificate (official seal icon) - Arrow down with "signs" label - End-Entity Certificate (server/website icon) - Trust validation arrows flowing upward - "Trusted Root Store" indicator at top

The recipient validates the certificate by following the chain through any intermdiate CAs up to find a trusted root CA, verifying each signature in the chain.


## Fundamentals of Transport Layer Security

### Standard TLS: Server Authentication

**[DIAGRAM: Standard TLS Handshake Flow]** _Sequence diagram with two columns (Client | Server) showing:_ _1. Client Hello →_ _2. ← Server Hello + Certificate_ _3. Certificate Verification (client-side check icon)_ _4. Key Exchange ↔_ _5. Secure Communication (encrypted data flow with lock icons)_

In typical HTTPS connections, only the **server** proves its identity through this one-way authentication process.

### Mutual TLS (mTLS): Two-Way Authentication

**[DIAGRAM: mTLS Handshake Flow] Enhanced sequence diagram showing: Client | Server columns with bidirectional certificate exchange 1. Client Hello → 2. ← Server Hello + Server Certificate 3. ← Certificate Request 4. Client Certificate → 5. Mutual Certificate Verification (both sides with check icons) 6. Key Exchange ↔ 7. Certificate Verify → 8. Secure Communication (double-encrypted data flow)

**Mutual TLS (mTLS)** extends standard TLS by requiring **both** parties to authenticate each other Each must have a private-public key pair and shares its certificate with the other party.

This provides stronger security because:

- The server knows that the client is who they claim to be
- The client knows that the server is legitimate
- Both parties are cryptographically verified


## Certificate Management

Tyk Dashboard provides a Certificate Management API for the registration (and deregistration) of certificates with Tyk so that they can be used by the Gateway when handling API requests. When a certificate is registered with Tyk it is assigned a unique certificate ID which can then be used to refer to that certificate from API definitions and Gateway configuration.

For Tyk OSS users, a basic Certificate Management API is also exposed by the Tyk Gateway.

A legacy option is the use of the file-system local to the Gateway. There is no specific default path for certificates in the file system - you can place them anywhere as long as the Tyk Gateway process has read access to that location. When using the file-system, references to certificates are made using the relative path to the certificate's `.pem` file.

### Tyk Certificate Store

The Tyk Certificate Store provides centralized certificate management across your deploymennt. Certificates are stored securely within Tyk's data layer and can be referenced by multiple APIs and policies. The Tyk Dashboard exposes an API to manage the certificate store.

In a Tyk Pro installation, the Dashboard manages the Tyk Certificate Store in the persistent storage (e.g. MongoDB or PostgreSQL database). When you add a certificate through the Dashboard UI or API, it's stored in the database and then synchronized to Redis for the Gateway to use.

In a Tyk OSS installation, there is no Dashboard/Control Plane. The Gateway manages the certificates directly, storing them in Redis.

### Certificate ID and Redis key

When a certificate is added to the store, it is assigned a **certificate ID** which is then used to refer to the certificate, for example when associating it with an API definition. The certificate ID is a string formed from a combination of the `orgID` and the SHA256 hash (fingerprint) of the certificate.

This means that certificate IDs are predictable, and can be calculated if you know the Organisation ID and have the certificate file. You can generate the SHA256 fingerprint using the following command:

```
openssl x509 -noout -fingerprint -sha256 -inform pem -in <cert>
```

**[DIAGRAM: certificate ID]** A Tyk certificate ID constructed from the Organisation ID and certificate. The certificate is hashed using SHA256 and appended to the orgID.

When synced to Redis, the certificate will be stored with a key comprised of `cert-raw-` concatenated with the certificate ID.

**[DIAGRAM: worked example of a certificate being added to the Tyk Certificate Store (in persistent database) and then synced to Redis]** Certificate added to cert store; certID generated; stored in persistent database where the key is the certID; synced to Redis where the key is `cert-raw-{certID}`.

<Note>
  You may notice that you can’t retrieve the raw certificate from the certificate ID, only its meta information. This is to ensure security.
</Note>

### Certificate data

The data stored against a certificateID is the [PEM-encoded](https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail) certificate chain data, comprising:

1. The Certificate(s):
    - The primary X.509 certificate
    - Any intermediate certificates in the chain
2. Encrypted Private Key (if provided):
    - If a private key was included with the certificate, it's encrypted using AES-256
    - The encryption uses the `private_certificate_encoding_secret` from your Tyk configuration
    - The encrypted key is appended to the certificate chain with the header `ENCRYPTED PRIVATE KEY`

A typical certificate with private key would be stored as:
```
-----BEGIN CERTIFICATE-----
MIIDazCCAlOgAwIBAgIUJhdB...
... (certificate data) ...
-----END CERTIFICATE-----

-----BEGIN ENCRYPTED PRIVATE KEY-----
MIIFHDBOBgkqhkiG9w0BBQ0w...
... (encrypted private key data) ...
-----END ENCRYPTED PRIVATE KEY-----
```

#### Encryption of the Private Key

If the private key was provided in the imported PEM file, this will be encrypted using the AES-256 algorithm using an encryption key that you must configure in the Gateway, Dashboard and MDCB configurations (if used).

- **Gateway**: [`TYK_GW_SECURITY_PRIVATECERTIFICATEENCODINGSECRET`](/tyk-oss-gateway/configuration#security-private-certificate-encoding-secret)
- **Dashboard**: [`TYK_DB_SECURITY_PRIVATECERTIFICATEENCODINGSECRET`](/tyk-dashboard/configuration#security-private-certificate-encoding-secret)
- **MDCB**: [`TYK_MDCB_SECURITY_PRIVATECERTIFICATEENCODINGSECRET`](/tyk-multi-data-centre/mdcb-configuration-options#security-private_certificate_encoding_secret)

It is essential that these secrets match, so that the Gateway can decrypt the key when required during a TLS handshake.

    <Note>
    It is important to keep the shared secret secure.
    </Note>

#### Standalone Public Key

Stand-alone public keys (not contained within a certificate) are sometimes used for upstream certificate pinning or JWT verification.

If only the public key was provided, rather than the certificate containing that key, then just the PEM-encoded public key will be stored against the certificateID, for example:

```
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA...
-----END PUBLIC KEY-----
```

### Monitoring Certificate Expiry

X.509 certificates have a validity period with both start and end timestamps outside which they will not be accepted in the TLS handshake.

Tyk Gateway checks the validity of each certificate when it is used in an API request and will generate both an error log and a [Gateway event](/api-management/gateway-events#certificate-expiry-events) if an attempt is made to use an expired certificate (after its `notAfter` timestamp).

An additional optional warning can be configured that will generate a log and Gateway event if a certificate is used within a configurable window before the `notAfter` timestamp.

- `CertificateExpired`: an expired certificate has been used in a request
- `CertificateExpiringSoon`: a certificate has been used within the expiry threshold window

The behavior of this Certificate Expiry Monitor is configured at the Gateway level using the following fields in the `security.certificate_expiry_monitor` section of the [Gateway configuration](/tyk-oss-gateway/configuration#security-certificate-expiry-monitor) (or equivalent environment variables):

| Field | Effect |
|-------|--------|
| [`warning_threshold_days`](/tyk-oss-gateway/configuration#security-certificate-expiry-monitor-warning-threshold-days) | The number of days before certificate expiry that the Gateway will start generating CertificateExpiringSoon events when the certificate is used |
| [`check_cooldown_seconds`](/tyk-oss-gateway/configuration#security-certificate-expiry-monitor-check-cooldown-seconds) | A cool-off period after checking a certificate's expiry before another check is made, to avoid unnecessary log generation when an API is called repeatedly |
| [`event_cooldown_seconds`](/tyk-oss-gateway/configuration#security-certificate-expiry-monitor-event-cooldown-seconds) | A cool-off period after generating `CertificateExpired` or `CertificateExpiringSoon` for a certificate, to avoid unnecessary event generation when an API is called repeatedly |

Note that the certificate expiry monitor is reactive and only checks for certificate expiry when the certificate is used; it will not flag impending expiry or expired certificates if they are not actively used.

[Event handlers](/api-management/gateway-events#handling-events-with-tyk) can be configured at the API level to respond to the generation of the Gateway events.

### Tyk Certificate Store API

The Tyk Dashboard API exposes [endpoints](/api-reference/certificates) to manage the Tyk Certificate Store allowing you to:

- Register a new certificate with the store
    - provide either a PEM-encoded certificate (optionally concatenated with PEM-encoded private key) or a PEM-encoded public key
    - this returns the assigned certificate ID
- Retrieve details of a specific entry in the store
    - provide a certificate ID
    - this returns metadata including the certificate issuer, whether there is a private key and the certificate fingerprint (SHA256 hash of the certificate)
- Retrieve a list of all certificates in the store
- Delete a certificate from the store
- Retrieve a list of APIs that are using a certificate

There is a similar API exposed by [Tyk Gateway](/api-reference/certs), for use in Tyk OSS installations to manage the certificates stored in Redis. This does not include the advanced functionality of identifying the APIs that are using each certificate.

### Managing Certificates using the Dashboard UI

The Tyk Dashboard provides a visual interface to the Tyk Certificate Store via the **API Security > TLS/SSL Certificates** screen.

**IMAGE

This screen displays a list of certificates registered in the store; any for which the [certificate expiry monitor](/api-management/certificates#monitoring-certificate-expiry) has generated an event with be highlighted with a warning or error symbol; a banner will be displayed to highlight these symbols.

Click on the certificate ID or select **View** from the **Actions** menu to view details of the certificate, including a list of APIs currently using the certificate.

**IMAGE

You can click on the name of an API in this list to go directly to that API in the API Designer. Note that this will list all APIs, even those for which the logged in user does not have [access](/api-management/user-management#api-ownership). This is to mitigate against the scenario where a certificate is deleted because the user believes it is unused. Users are unable to click through to APIs to which they do not have access.

You can upload a new certificate to the Tyk Certificate Store using the **+ Add Certificate** button.

**IMAGE

Select either a valid PEM-encoded file containing a certificate, or a file containing PEM-encoded certificate concatenated with the PEM-encoded private key, and select **Upload**. If successful, the certificate will be loaded into the Certificate Store and assigned a certificate ID that you can use to associate it with a TLS interaction via API definition or Gateway configuration.

